{% if data %}
    <div>
        <h2>Preview</h2>
        {% if rows > total_rows %}
            <p>Showing {{ total_rows }} of {{ total_rows }} total rows. <a href="download">Download CSV</a> (all rows)</p>
        {% else %}
            <p>First <input style="text-align: center; width: 40px;" type="text" name="rows" id="rows" value="{{ rows }}" /> of {{ total_rows }} total rows. <a href="download">Download CSV</a></p>
        {% endif %}
        <div style="overflow: auto; height: 500px;" id="overflow_wrapper">
            <table class="table table-striped table-hover" id="preview">
                <thead style="background: white;">
                    <tr>
                        {% for h in headers %}
                            <th>{{ h }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for row in data %}
                    <tr>
                        {% for i in row %}
                            <td>{{ i }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <script src="//rawgithub.com/mkoryak/floatThead/master/jquery.floatThead.js"></script>
    <script>
        $(document).ready( function () {
            var $table = $('#preview');
            $table.floatThead({
                scrollContainer: function($table){
                    return $table.closest('#overflow_wrapper');
                }
            });
            var $rows = $('#rows');
            var showRows = function() {
                var rows = $rows.val();
                window.location.href = '?rows=' + rows;
            }
            $rows.change(showRows);
            $rows.keyup(function(event){
                if(event.keyCode == 13){ showRows(); }
            });
        } );
    </script>
{% endif %}