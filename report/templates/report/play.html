{% extends "report/base.html" %}

{% block navlinks %}
    <li><a href="../new/">New Report</a></li>
    <li class="active"><a href="#">Playground</a></li>
{% endblock %}

{% block content %}
<h2>Playground</h2>
    <p>The playground is for experimenting and writing ad-hoc queries. By default, nothing you do here will be saved.</p>
<div>
    <form role="form" action="/report/play/" method="post">{% csrf_token %}
        {% if form.sql.errors %}{% for error in form.sql.errors %}
            <div class="alert alert-danger">{{ error|escape }}</div>
        {% endfor %}{% endif %}
        <div class="panel panel-default" style="margin-top: 30px;" xmlns="http://www.w3.org/1999/html">
            <div class="panel-heading">
                <span class="panel-title">SQL</span>
            </div>
            <div class="panel-content">
                <textarea class="form-control" cols="40" id="id_sql" name="sql" rows="10">{{ sql }}</textarea>
            </div>
        </div>
        <div class="form-group">
            <div style="text-align: center;">
                <input type="submit" value="Refresh Preview" class="btn btn-default"/>
                <input type="submit" value="Create New Report" id="create_button" class="btn btn-default"/>
                <a class="btn btn-default" target="_blank" href="../schema/">Schema Reference</a>
            </div>
        </div>
    </form>
    {% include 'report/preview_pane.html' %}
</div>
{% endblock %}

{% block scripts %}
    {% include 'report/preview_pane_scripts.html' %}
    {% include 'report/sql_editor_scripts.html' %}
    <script>
        $(function() {
            $("#create_button").click(function() {
                $(this).closest("form").attr('action', '/report/new/');
            });
        });
    </script>
{% endblock %}


